module Test_newFormatParser_mod
   use pFUnit_mod
   use ASTG_NewFormatParser_mod
   use ASTG_FormatToken_mod
   implicit none

contains


@test
   subroutine test_trivial()
      type (FormatParser) :: p

      p = FormatParser()
      call p%parse('')
      @assertEqual(0, p%size())


   end subroutine test_trivial

@test
   subroutine test_simple()
      type (FormatParser) :: p
      type (FormatToken), pointer :: t

      p = FormatParser()
      call p%parse('a')
      @assertEqual(1, p%size())

      t => p%at(1)
      @assertEqual('a', t%text)

   end subroutine test_simple


end module Test_newFormatParser_mod
