module Test_Filter_mod
   use pFUnit_mod
   use ASTG_Filter_mod
   use ASTG_LogRecord_mod
   use FTL_Object_mod
   use FTL_CaseInsensitiveString_mod

contains

   @test
   subroutine test_defaultFilterNameMismatch()
      use FTL_Object_mod
      type (Filter) :: f
      type (LogRecord) :: record

      f = Filter('A')
      record = LogRecord('B', INFO, 'some message')

      @assertFalse(f%filter(record))
      
   end subroutine test_defaultFilterNameMismatch


   @test
   subroutine test_defaultFilterNameMatch()
      type (Filter) :: f
      type (LogRecord) :: record

      f = Filter('A')
      record = LogRecord('A', INFO, 'some message')

      @assertTrue(f%filter(record))
      
   end subroutine test_defaultFilterNameMatch


   @test
   subroutine test_defaultFilterPartialMatch()
      type (Filter) :: f
      type (LogRecord) :: record

      f = Filter('A')
      record = LogRecord('AB', INFO, 'some message')
      @assertTrue(f%filter(record))

      f = Filter('AB')
      record = LogRecord('A', INFO, 'some message')
      @assertFalse(f%filter(record))
      

   end subroutine test_defaultFilterPartialMatch

   @test
   subroutine test_equal_same()
      type (Filter) :: f

      f = Filter('A')
      @assertEqualUserDefined(f,f)
      @assertFalse(f /= f)

   end subroutine test_equal_same


   @test
   subroutine test_equal_different()
      type (Filter) :: fa, fb

      fa = Filter('A')
      fb = Filter('B')
      @assertFalse(fa == fb)
      @assertTrue(fa /= fb)

   end subroutine test_equal_different


   @test
   subroutine test_filterCaseInsensitive()
      type (Filter) :: f
      type (LogRecord) :: record

      f = Filter('A')
      record = LogRecord('a', INFO, 'some message')

      @assertTrue(f%filter(record))

   end subroutine test_filterCaseInsensitive


end module Test_Filter_mod
