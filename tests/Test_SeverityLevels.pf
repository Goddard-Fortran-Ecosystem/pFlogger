module Test_SeverityLevels_mod
   use pFUnit_mod
   use ASTG_SeverityLevels_mod
   use iso_fortran_env
   
   implicit none

contains

   
   @test
   subroutine test_levelToName()
      
      ! Level numeric values range from NOTSET=0 to CRITICAL=50
      @assertEqual('NOTSET', levelToName(NOTSET))
      @assertEqual('CRITICAL', levelToName(CRITICAL))

   end subroutine test_levelToName


   @test
   subroutine test_levelToName_unnamedLevel()
      
      character(len=:), allocatable :: levelName

      ! The following should throw an exception, because
      ! it is a level that is not named.
      levelName = levelToName(CRITICAL + 100)
      ! Catch it here:
      @assertExceptionRaised('Unknown level. Please use a valid level.')
      
   end subroutine test_levelToName_unnamedLevel

end module Test_SeverityLevels_mod
